name: canadian-baseball-network-scrape
on:
   schedule:
      - cron: '40 4 * * *' # runs at 4:40 UTC everyday
jobs:
   build:
      runs-on: ubuntu-latest
      steps:
         - name: checkout repo content
            uses: actions/checkout@v2 # checkout the repository content to github runner
         - name: setup python
            uses: actions/setup-python@v2
            with:
               python-version: '3.7.9' # install the python version needed
         - name: install python packages
            run: |
               python -m pip install --upgrade pip
               pip install -r requirements.txt
         - name: execute py script # run roster_scrape.py to get the latest data
            env:
               SHEET_TYPE: ${{ secrets.SHEET_TYPE }}
               SHEET_PROJECT_ID: ${{ secrets.SHEET_PROJECT_ID }}
               SHEET_PRIVATE_KEY_ID: ${{ secrets.SHEET_PRIVATE_KEY_ID }}
               SHEET_PRIVATE_KEY: ${{ secrets.SHEET_PRIVATE_KEY }}
               SHEET_CLIENT_EMAIL: ${{ secrets.SHEET_CLIENT_EMAIL }}
               SHEET_CLIENT_ID: ${{ secrets.SHEET_CLIENT_ID }}
               SHEET_AUTH_URI: ${{ secrets.SHEET_AUTH_URI }}
               SHEET_TOKEN_URI: ${{ secrets.SHEET_TOKEN_URI }}
               SHEET_AUTH_PROVIDER_X509_CERT_URL: ${{ secrets.SHEET_AUTH_PROVIDER_X509_CERT_URL }}
               SHEET_CLIENT_X509_CERT_URL:  ${{ secrets.SHEET_CLIENT_X509_CERT_URL }}
            run: python Projects/Canadian_Baseball_Network/roster_scrape.py
         - name: commit files
            run: |
               git config --local user.email "action@github.com"
               git config --local user.name "GitHub Action"
               git add -A
               git commit -m "auto-run roster_scrape.py" -a
         - name: push changes
            uses: ad-m/github-push-action@v0.6.0
            with:
               github_token: ${{ secrets.GITHUB_TOKEN }}
               branch: main